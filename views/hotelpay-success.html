<!DOCTYPE html>
<html lang="cn">
<head>
    <%-include("common/headinfo.html",{h_tit:'平乐古镇·天台山旅游电子商务平台_首页'})%>
</head>
<body>
<!--页头-->
<%-include("common/header.html")%>
<!--&lt;!&ndash; 导航 &ndash;&gt;-->
<!--<%-include("common/nav.html")%>-->
<!--&lt;!&ndash;面包削&ndash;&gt;-->
<!--<div class="crumbs">-->
    <!--<div class="js_curmbs center"></div>-->
<!--</div>-->
    <!--支付流程状态-->
    <ul class="paytype center clearfix">
        <li class="paytype1"><i>1</i>填写订单</li>
        <li class="paytype2 curr"><i>2</i>在线支付</li>
        <li class="paytype3 curr"><i>3</i>完成</li>
    </ul>
    <!--订单信息-->
    <div class="order-page">

    </div>
    <!--页尾-->
    <%-include("common/footer.html")%>
    <!--订单详情模板-->
    <script type="text/template" id="payOrderInfoTemp">
        <div class="font1">
            <i class="daq-icon">&#xe6b6;</i>
            <p class="p1">订单支付成功</p>
            <p class="p2">电子码已发送到${list.contactMobile} 请注意查收！！入住规则：${list.passType}</p>
        </div>
        <div class="font2">
            <p class="p1">${list.productName}</p>
            <p class="p2">博尔塔拉蒙古自治州    北京路154号</p>
            <table>
                <tr>
                    <td class="tb1">订单号:</td>
                    <td class="tb2">${list.sn}</td>
                </tr>
                <tr>
                    <td class="tb1">预订房型</td>
                    <td class="tb2">标准间 ${list.quantity}间</td>
                </tr>
                <tr>
                    <td class="tb1">预订时间:</td>
                    <td class="tb2">${list.date}(${list.weekDay}) 入住  -  ${list.edate}离店  <span>共${list.daycha}晚</span></td>
                </tr>
                <tr>
                    <td class="tb1">费用总计:</td>
                    <td class="tb2">&yen; ${list.paymentAmount}</td>
                </tr>
            </table>
            <!--手机二维码-->
            <!--<div class="appcode-box">-->
                <!--<div class="imgbox">-->
                    <!--<img src="image/appcode.png" alt="">-->
                <!--</div>-->
            <!--</div>-->
        </div>
        <div class="font3">
            <a href="index.html" class="tohome">返回首页</a>
            <a href="personalCenter-allorder.html?type=room" class="toorder">查看订单</a>
        </div>
    </script>
<script>
    var indexJs = {
        init:function () {
            tools.setTowLevelBanner();
            this.getOrderDetail();
        },
        // 获取订单详情
        getOrderDetail: function () {
            var _this = this;
            var $orderTmpl = $("#payOrderInfoTemp");
            var $orderWrapper = $('.order-page');
            $orderWrapper.empty();
            var betoken = tools.getCookie('token')
            var loading = tools.loading($orderWrapper);
            var params = {
                url: 'ds/qiandnApi/order-pc/order-details',
                type: true,
                data: {
                    category: 'room',
                    orderId: tools.getUrlParams('id'),
                    token: betoken
                }
            };
            if (betoken) {
                tools.request(params, function (res) {
                    loading.clean();
                    //计算 共计天数
                    res.data.canUseDate = res.data.canUseDate.substring(0,10);
                    var daycha = _this.countDay(res.data.canUseDate,res.data.edate);
                    res.data.daycha = daycha
                    $orderTmpl.tmpl({list: res.data}).appendTo($orderWrapper);
                })
            }
        },
        countDay: function (aDate,bDate) {
            var anewDate = new Date(aDate); // 通过日期字符串，初始化第一个日期对象
            var bnewDate = new Date(bDate); // 同上，初始化第二个日期对象
            var aDay = 24 * 60 * 60 * 1000; // 完整一天有24小时，将小时换算成毫秒时间戳
            var diffDay = (bnewDate - anewDate) / aDay; // 计算间隔天数（注意日期隐式转换）
            return diffDay
        }
    }
    $(function() {
        indexJs.init();
    })
</script>
</body>
</html>
